# 电竞经理2 - 前端代码详细说明文档

> 本文档详细描述前端项目的架构、模块、文件结构和核心逻辑实现。

---

## 目录

1. [项目概述](#1-项目概述)
2. [技术栈](#2-技术栈)
3. [项目结构](#3-项目结构)
4. [类型定义系统](#4-类型定义系统)
5. [状态管理 (Stores)](#5-状态管理-stores)
6. [核心引擎](#6-核心引擎)
7. [API 接口层](#7-api-接口层)
8. [路由系统](#8-路由系统)
9. [页面视图](#9-页面视图)
10. [数据流架构](#10-数据流架构)

---

## 1. 项目概述

电竞经理2是一款模拟电竞赛事管理的游戏，玩家扮演战队经理，管理战队、选手、参与各类赛事。

### 1.1 核心功能

| 功能模块 | 描述 |
|---------|------|
| 战队管理 | 管理56支战队（4赛区×14队），包括阵容、战力等 |
| 选手管理 | 选手能力、潜力、稳定性、状态、合同等 |
| 赛事系统 | 14个阶段的完整赛季循环 |
| 积分系统 | 年度积分排名、赛区积分榜 |
| 转会系统 | 选手转会、自由球员签约 |
| 选秀系统 | 每4赛季一次选秀 |
| 荣誉殿堂 | 历史冠军、成就记录 |

### 1.2 赛季阶段（14个）

```
春季赛常规赛 → 春季赛季后赛 → MSI季中邀请赛 → 马德里大师赛 →
夏季赛常规赛 → 夏季赛季后赛 → Claude洲际赛 → S世界赛 →
上海大师赛 → ICP洲际对抗赛 → Super洲际邀请赛 →
转会期 → 选秀 → 赛季结束
```

---

## 2. 技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue 3 | 3.x | 前端框架（Composition API） |
| TypeScript | 5.x | 类型安全 |
| Pinia | 2.x | 状态管理 |
| Vue Router | 4.x | 路由管理 |
| Element Plus | 2.x | UI组件库 |
| Tauri | 2.x | 桌面应用框架 |
| Vite | 5.x | 构建工具 |

---

## 3. 项目结构

```
src/
├── api/                    # API接口层
│   ├── client.ts          # Axios客户端配置
│   └── index.ts           # 所有API模块导出（11个模块）
│
├── engines/                # 核心计算引擎
│   ├── PlayerEngine.ts    # 选手能力计算引擎
│   └── PowerEngine.ts     # 战队战力与比赛模拟引擎
│
├── stores/                 # Pinia状态管理（17个Store）
│   ├── useSeasonStore.ts  # 赛季管理
│   ├── useTeamStore.ts    # 战队管理
│   ├── usePlayerStore.ts  # 选手管理
│   ├── useRegionStore.ts  # 赛区管理
│   ├── useEventStore.ts   # 赛事管理
│   ├── useScheduleStore.ts # 赛程管理
│   ├── usePlayoffStore.ts # 季后赛管理
│   ├── useMSIStore.ts     # MSI赛事管理
│   ├── useWorldsStore.ts  # 世界赛管理
│   ├── useRankingStore.ts # 积分排名管理
│   ├── usePointsStore.ts  # 积分详情管理
│   └── ...更多Store
│
├── types/                  # TypeScript类型定义（6个文件）
│   ├── index.ts           # 主类型定义（1145行）
│   ├── player.ts          # 选手相关类型
│   ├── matchDetail.ts     # 比赛详情类型
│   ├── clauch.ts          # C洲际赛类型
│   ├── super.ts           # Super洲际赛类型
│   └── icp.ts             # ICP洲际对抗赛类型
│
├── views/                  # 页面组件（20+页面）
│   ├── Dashboard.vue      # 仪表盘
│   ├── Tournaments.vue    # 赛事管理
│   ├── Teams.vue          # 战队管理
│   ├── Players.vue        # 选手中心
│   ├── Rankings.vue       # 积分排名
│   ├── MSIDetail.vue      # MSI详情
│   ├── WorldsDetail.vue   # 世界赛详情
│   └── ...更多页面
│
├── router/                 # 路由配置
│   └── index.ts           # 路由定义
│
└── App.vue                # 根组件
```

---

## 4. 类型定义系统

### 4.1 核心类型 (`types/index.ts`)

#### 战队类型

```typescript
interface Team {
  id: string
  name: string
  regionId: string
  strength: number              // 战队战力（0-100）

  statistics?: {
    totalMatches: number
    wins: number
    losses: number
    winRate: number
    totalPoints: number         // 年度积分
    seasonPoints: number        // 赛季积分
    intercontinentalPoints: number // 洲际赛积分（不计入排名）
  }
}
```

#### 赛区类型

```typescript
interface Region {
  id: string
  name: string                  // 'LPL' | 'LCK' | 'LEC' | 'LCS'
  teams?: Team[]
}
```

#### 赛季类型

```typescript
interface Season {
  id: string | number
  seasonCode: string            // 'S1', 'S2', ...
  year: number
  status: SeasonStatus          // 'planning' | 'active' | 'completed'
}
```

#### 赛事类型

```typescript
interface Competition {
  id: string | number
  competitionCode: string       // 'S1-spring', 'S1-msi', ...
  name: string
  type: CompetitionType         // 'spring' | 'summer' | 'msi' | 'worlds' | ...
  format: CompetitionFormat     // 'regular_season' | 'playoffs' | 'knockout'
  seasonId: string | number
  regionId?: string
  status: CompetitionStatus     // 'planned' | 'ongoing' | 'completed'
  teams: Team[]
  matches: Match[]
}

type CompetitionType =
  | 'spring'          // 春季赛
  | 'summer'          // 夏季赛
  | 'msi'             // MSI季中邀请赛
  | 'worlds'          // S世界赛
  | 'intercontinental' // 洲际赛
  | 'madrid'          // 马德里大师赛
  | 'shanghai'        // 上海大师赛
  | 'icp'             // ICP洲际对抗赛
  | 'super'           // Super洲际邀请赛
```

#### 比赛类型

```typescript
interface Match {
  id: string
  competitionId: string
  homeTeamId?: string
  awayTeamId?: string
  teamAId?: string
  teamBId?: string
  teamAName?: string
  teamBName?: string
  scoreA?: number
  scoreB?: number
  winnerId?: string
  round?: number
  roundNumber?: number
  stage?: string
  regionId?: string
  status: 'scheduled' | 'live' | 'completed'
  result?: MatchResult
}
```

### 4.2 选手类型 (`types/player.ts`)

```typescript
interface Player {
  id: string
  name: string
  gameId: string                // 游戏ID
  age: number                   // 17-36岁
  position: Position            // 'TOP' | 'JUG' | 'MID' | 'ADC' | 'SUP'
  teamId: string

  // 核心属性
  ability: number               // 当前实力（0-100）
  potential: number             // 潜力值（0-100）
  stability: number             // 稳定性（0-100）
  condition: number             // 状态加成（-5 ~ +8）

  // 合同
  contractYears: number
  salary: number                // 年薪（万元）
}

interface PlayerPerformance {
  playerId: string
  playerName: string
  position: Position
  teamId: string
  baseAbility: number           // 基础能力
  conditionBonus: number        // 状态加成
  stabilityNoise: number        // 稳定性噪声
  actualAbility: number         // 实际发挥
  impactScore: number           // 影响力分数
}
```

### 4.3 比赛详情类型 (`types/matchDetail.ts`)

```typescript
interface GameDetail {
  gameNumber: number
  teamAId: string
  teamAName: string
  teamAPower: number            // A队战力
  teamAPerformance: number      // A队发挥值
  teamAPlayers: PlayerPerformance[]
  teamBId: string
  teamBName: string
  teamBPower: number
  teamBPerformance: number
  teamBPlayers: PlayerPerformance[]
  winnerId: string
  winnerName: string
  powerDifference: number       // 战力差
  performanceDifference: number // 发挥差
  isUpset: boolean              // 是否爆冷
}

interface MatchDetail {
  matchId: string
  teamAId: string
  teamAName: string
  teamBId: string
  teamBName: string
  bestOf: number                // BO1/BO3/BO5
  games: GameDetail[]           // 每局详情
  finalScoreA: number
  finalScoreB: number
  winnerId: string
  winnerName: string
  mvpPlayerId?: string
  mvpPlayerName?: string
  mvpTeamId?: string
  mvpTotalImpact?: number
  keyPlayer?: {
    playerId: string
    playerName: string
    reason: '高发挥' | '低发挥'
    impactScore: number
    gameNumber: number
  }
  playedAt: Date
}
```

---

## 5. 状态管理 (Stores)

### 5.1 Store架构概览

```
┌─────────────────────────────────────────────────────────────────┐
│                        Pinia Store 层                           │
├─────────────┬─────────────┬─────────────┬─────────────────────┤
│ useSeasonStore │ useTeamStore │ usePlayerStore │ useRegionStore │
├─────────────┴─────────────┴─────────────┴─────────────────────┤
│ useEventStore │ useScheduleStore │ usePlayoffStore │ useMSIStore │
├─────────────┴─────────────┴─────────────┴─────────────────────┤
│ useWorldsStore │ useRankingStore │ usePointsStore │ 更多...     │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 useSeasonStore - 赛季管理

**文件**：`src/stores/useSeasonStore.ts`

**功能**：管理游戏赛季和阶段进度

```typescript
const useSeasonStore = defineStore('season', () => {
  // 状态
  const seasons = ref<SeasonData[]>([])
  const activeSeasonId = ref<string>('S1')
  const viewingSeasonId = ref<string>('S1')

  // 14个游戏阶段
  const GAME_PHASES: PhaseInfo[] = [
    { id: 'spring_regular', name: '春季赛常规赛', order: 1 },
    { id: 'spring_playoffs', name: '春季赛季后赛', order: 2 },
    { id: 'msi', name: 'MSI 季中邀请赛', order: 3 },
    { id: 'madrid', name: '马德里大师赛', order: 4 },
    // ... 共14个阶段
  ]

  // 方法
  const advancePhase = () => { /* 推进到下一阶段 */ }
  const startNewSeason = () => { /* 开始新赛季 */ }
  const canAccessPhase = (phase) => { /* 检查阶段是否可访问 */ }
})
```

### 5.3 useScheduleStore - 赛程管理

**文件**：`src/stores/useScheduleStore.ts`（1005行）

**功能**：管理常规赛赛程、积分榜、比赛模拟

```typescript
const useScheduleStore = defineStore('schedule', () => {
  // 状态
  const currentRound = ref<number>(1)
  const totalRounds = ref<number>(18)        // 双循环26轮
  const matches = ref<Match[]>([])
  const scoreboards = ref<TeamScore[]>([])
  const isSimulating = ref<boolean>(false)

  // 计算属性
  const regionSchedules = computed(() => {
    // 按赛区分组比赛和积分榜
    return { LPL: {...}, LCK: {...}, LEC: {...}, LCS: {...} }
  })

  // 方法
  const loadSchedule = async (competitionId) => { /* 加载赛程 */ }
  const simulateRegionCurrentRound = async () => { /* 模拟当前轮次 */ }
  const updateScoreboard = async () => { /* 更新积分榜 */ }
  const completeRegularSeason = async () => { /* 完成常规赛 */ }
})

// 内置模拟引擎
class MatchSimulationEngine {
  calculateMatchResult(teamA, teamB) {
    // 基于战力差和随机因素计算比赛结果
    const winProbability = 1 / (1 + Math.exp(-powerDiff / 10))
    // ...
  }
}

class ScoreCalculator {
  updateScoreboard(results, currentScoreboard, matches) {
    // BO3积分规则：2-0得3分，2-1得2分，1-2得1分，0-2得0分
    // ...
  }
}
```

### 5.4 usePlayoffStore - 季后赛管理

**文件**：`src/stores/usePlayoffStore.ts`（463行）

**功能**：管理季后赛对阵、模拟BO5

```typescript
const usePlayoffStore = defineStore('playoff', () => {
  // 状态
  const playoffBrackets = ref<Map<string, PlayoffBracket>>(new Map())
  const currentBracket = ref<PlayoffBracket | null>(null)

  // 计算属性
  const champion = computed(() => currentBracket.value?.champion)
  const runnerUp = computed(() => currentBracket.value?.runnerUp)

  // 方法
  const fetchPlayoffBracket = async (competitionId, regionId) => {}
  const generatePlayoff = async (request) => {}
  const simulatePlayoffMatch = async (request) => {}
  const batchSimulatePlayoff = async (bracket, onProgress) => {
    // 一键模拟整个季后赛
  }
})
```

### 5.5 useMSIStore - MSI赛事管理

**文件**：`src/stores/useMSIStore.ts`（273行）

**功能**：管理MSI季中邀请赛

```typescript
const useMSIStore = defineStore('msi', () => {
  // MSI参赛队伍：各赛区春季赛冠亚季军（共12支）
  // 赛制：双败淘汰BO5

  // 状态
  const msiBrackets = ref<Map<string, MSIBracket>>(new Map())
  const currentBracket = ref<MSIBracket | null>(null)

  // 积分分配
  // 冠军: 20分, 亚军: 16分, 季军: 12分, 殿军: 8分
  // 败者组R2: 6分, 败者组R1: 4分

  // 方法
  const generateMSI = async (request) => {}
  const simulateMSIMatch = async (request) => {}
})
```

### 5.6 useWorldsStore - 世界赛管理

**文件**：`src/stores/useWorldsStore.ts`（702行）

**功能**：管理S世界赛（瑞士轮+淘汰赛）

```typescript
const useWorldsStore = defineStore('worlds', () => {
  // 世界赛参赛队伍：各赛区夏季赛前4名（共16支）

  // 状态
  const currentWorlds = ref<WorldsData>({
    season: 'S1',
    status: 'NOT_STARTED'
  })
  const swissStandings = ref<any[]>([])      // 瑞士轮积分榜
  const currentSwissRound = ref(0)            // 当前瑞士轮轮次
  const knockoutMatches = ref<any[]>([])      // 淘汰赛比赛

  // 状态流转
  // NOT_STARTED → PLAY_IN_DRAW → GROUP_STAGE → KNOCKOUT → COMPLETED

  // 方法
  const createWorlds = async () => {}
  const startGroupStage = async () => {}      // 开始瑞士轮
  const generateSwissRound = async () => {}   // 生成瑞士轮配对
  const simulateSwissMatch = async () => {}   // 模拟瑞士轮比赛
  const generateKnockoutBracket = async () => {} // 生成淘汰赛
  const simulateKnockoutMatch = async () => {}   // 模拟淘汰赛
})
```

### 5.7 useRankingStore - 积分排名管理

**文件**：`src/stores/useRankingStore.ts`（739行）

**功能**：管理赛区常规赛积分榜和年度积分排名

```typescript
const useRankingStore = defineStore('ranking', () => {
  // 积分配置
  const pointsConfig = ref<PointsConfig>({
    regular: { win: 3, loss: 0 },
    playoffs: {
      champion: 50, runnerUp: 35,
      semifinal: 25, quarterfinal: 15
    },
    international: {
      msi: { champion: 100, runnerUp: 80, semifinal: 60, groupStage: 20 },
      worlds: { champion: 150, runnerUp: 120, semifinal: 90, quarterfinal: 60, groupStage: 30 },
      intercontinental: { champion: 0, ... } // 不计入年度积分
    }
  })

  // 方法
  const fetchRegionalStandings = async (regionId, seasonId, type) => {}
  const fetchSeasonRankings = async (seasonId) => {}
  const updateRegionalStandings = async (...) => {}
  const refreshAllRankings = async (seasonId) => {}
})
```

### 5.8 usePointsStore - 积分详情管理

**文件**：`src/stores/usePointsStore.ts`（323行）

**功能**：管理战队积分详情和历史

```typescript
const usePointsStore = defineStore('points', () => {
  // 状态
  const seasonRankings = ref<SeasonPointsRanking[]>([])
  const teamPointsBreakdown = ref<Map<string, TeamPointsBreakdown>>(new Map())
  const teamPointsHistory = ref<Map<string, PointsHistory[]>>(new Map())

  // 积分类型
  interface TeamPointsBreakdown {
    teamId: number
    totalPoints: number
    springPoints: number          // 春季赛积分
    summerPoints: number          // 夏季赛积分
    springPlayoffPoints: number   // 春季季后赛积分
    summerPlayoffPoints: number   // 夏季季后赛积分
    msiPoints: number             // MSI积分
    worldsPoints: number          // 世界赛积分
    intercontinentalPoints: number // 洲际赛积分（展示用）
  }
})
```

---

## 6. 核心引擎

### 6.1 PlayerEngine - 选手能力引擎

**文件**：`src/engines/PlayerEngine.ts`（125行）

**算法**（策划案规定）：

```
稳定性标准差：σ = (100 - stability) / 10
实际能力 = 平均能力 + 状态加成 + 高斯噪声(0, σ)
钳位：[ability - 15, ability + 10]
```

```typescript
class PlayerEngine {
  /**
   * Box-Muller变换生成标准正态分布随机数
   */
  static gaussianRandom(): number {
    let u = 0, v = 0
    while (u === 0) u = Math.random()
    while (v === 0) v = Math.random()
    return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v)
  }

  /**
   * 计算稳定性对应的标准差
   * stability = 100 → σ = 0（完全稳定）
   * stability = 60  → σ = 4（波动大）
   * stability = 0   → σ = 10（极不稳定）
   */
  static calculateStabilitySigma(stability: number): number {
    return (100 - Math.max(0, Math.min(100, stability))) / 10
  }

  /**
   * 计算单个选手在一局比赛中的实际发挥
   */
  static calculatePerformance(player: Player): PlayerPerformance {
    const sigma = this.calculateStabilitySigma(player.stability)
    const noise = this.gaussianRandom() * sigma
    const rawAbility = player.ability + player.condition + noise

    // 钳位到合理范围
    const minAbility = Math.max(0, player.ability - 15)
    const maxAbility = Math.min(100, player.ability + 10)
    const actualAbility = Math.max(minAbility, Math.min(maxAbility, rawAbility))

    return {
      playerId: player.id,
      baseAbility: player.ability,
      conditionBonus: player.condition,
      stabilityNoise: Math.round(noise * 100) / 100,
      actualAbility: Math.round(actualAbility * 10) / 10,
      impactScore: 0  // 由PowerEngine计算
    }
  }

  /**
   * 年龄与稳定性基础值
   * 18-24岁（新星）：60-75
   * 25-29岁（巅峰）：75-85
   * 30-36岁（老将）：85-95
   */
  static getBaseStabilityByAge(age: number): number { ... }

  /**
   * 年龄与状态加成范围
   * ≤24岁：-5 ~ +8（"天神下凡"）
   * 25-29岁：-3 ~ +3
   * ≥30岁：0 ~ +2
   */
  static getConditionRange(age: number): { min: number; max: number } { ... }
}
```

### 6.2 PowerEngine - 战力引擎

**文件**：`src/engines/PowerEngine.ts`（294行）

**算法**（策划案规定）：

```
队伍战力 = Σ(5名选手实际能力) / 5
发挥值 = 正态分布(队伍战力, σ=6)
发挥值高者获胜
```

```typescript
class PowerEngine {
  private static readonly PERFORMANCE_SIGMA = 6

  /**
   * 计算队伍战力（基于5名选手的实际发挥）
   */
  static calculateTeamPower(performances: PlayerPerformance[]): number {
    const totalAbility = performances.reduce((sum, p) => sum + p.actualAbility, 0)
    return totalAbility / performances.length
  }

  /**
   * 计算队伍发挥值（正态分布）
   */
  static calculateTeamPerformanceValue(teamPower: number): number {
    const noise = this.gaussianRandom() * this.PERFORMANCE_SIGMA
    return teamPower + noise
  }

  /**
   * 计算选手影响力分数
   * 影响力 = 选手实际能力 - 队伍平均能力
   */
  static calculateImpactScores(performances, teamAverage): void {
    performances.forEach((p) => {
      p.impactScore = Math.round((p.actualAbility - teamAverage) * 10) / 10
    })
  }

  /**
   * 模拟单局比赛
   */
  static simulateGame(
    teamAId, teamAName, teamAPlayers,
    teamBId, teamBName, teamBPlayers,
    gameNumber
  ): GameDetail {
    // 1. 计算每位选手的实际发挥
    const teamAPerformances = PlayerEngine.calculateTeamPerformances(teamAPlayers)
    const teamBPerformances = PlayerEngine.calculateTeamPerformances(teamBPlayers)

    // 2. 计算队伍战力
    const teamAPower = this.calculateTeamPower(teamAPerformances)
    const teamBPower = this.calculateTeamPower(teamBPerformances)

    // 3. 计算队伍发挥值
    const teamAPerformanceValue = this.calculateTeamPerformanceValue(teamAPower)
    const teamBPerformanceValue = this.calculateTeamPerformanceValue(teamBPower)

    // 4. 决定胜负（发挥值高者获胜）
    const teamAWins = teamAPerformanceValue > teamBPerformanceValue

    // 5. 判断是否爆冷
    const isUpset = (teamAPower > teamBPower && !teamAWins) ||
                    (teamBPower > teamAPower && teamAWins)

    return { ... }
  }

  /**
   * 模拟完整比赛（BO1/BO3/BO5）
   */
  static simulateMatch(..., bestOf: number): MatchDetail {
    const winsNeeded = Math.ceil(bestOf / 2)
    const games: GameDetail[] = []
    let scoreA = 0, scoreB = 0

    while (scoreA < winsNeeded && scoreB < winsNeeded) {
      const game = this.simulateGame(...)
      games.push(game)
      if (game.winnerId === teamAId) scoreA++
      else scoreB++
    }

    // 分析MVP（累计影响力最高的选手）
    const analysis = this.analyzeMatch(games, teamAId)

    return {
      games,
      finalScoreA: scoreA,
      finalScoreB: scoreB,
      winnerId: scoreA > scoreB ? teamAId : teamBId,
      mvpPlayerId: analysis.mvp?.playerId,
      mvpTotalImpact: analysis.mvp?.totalImpact,
      ...
    }
  }
}
```

---

## 7. API 接口层

### 7.1 API模块概览

**文件**：`src/api/index.ts`（747行）

| API模块 | 功能 |
|---------|------|
| `teamApi` | 战队CRUD、统计、比赛历史 |
| `regionApi` | 赛区管理 |
| `seasonApi` | 赛季管理 |
| `competitionApi` | 赛事管理、赛程生成、轮次模拟 |
| `matchApi` | 比赛管理、模拟 |
| `rankingApi` | 积分排名 |
| `honorHallApi` | 荣誉殿堂 |
| `playoffApi` | 季后赛 |
| `msiApi` | MSI赛事 |
| `worldsApi` | 世界赛 |
| `pointsApi` | 积分详情 |
| `superApi` | Super洲际赛 |
| `clauchApi` | C洲际赛 |

### 7.2 核心API示例

```typescript
// 赛事API
export const competitionApi = {
  getCompetitions: (params?) => apiClient.get('/api/competitions', { params }),
  getCompetition: (id) => apiClient.get(`/api/competitions/${id}`),
  createCompetition: (data) => apiClient.post('/api/competitions', data),
  startCompetition: (id) => apiClient.post(`/api/competitions/${id}/start`),
  finishCompetition: (id) => apiClient.post(`/api/competitions/${id}/finish`),
  generateSchedule: (id) => apiClient.post(`/api/competitions/${id}/generate-schedule`),
  simulateRound: (id) => apiClient.post(`/api/competitions/${id}/simulate-round`),
  getCurrentRound: (id) => apiClient.get(`/api/competitions/${id}/current-round`),
}

// 季后赛API
export const playoffApi = {
  generatePlayoff: (data) => apiClient.post('/api/playoffs/generate', data),
  getPlayoffBracket: (competitionId, regionId) =>
    apiClient.get('/api/playoffs/bracket', { params: { competitionId, regionId } }),
  simulatePlayoffMatch: (data) => apiClient.post('/api/playoffs/simulate-match', data),
  checkPlayoffEligibility: (competitionId, regionId) =>
    apiClient.get('/api/playoffs/check-eligibility', { params: { competitionId, regionId } }),
}

// 世界赛API
export const worldsApi = {
  generateWorlds: (data) => apiClient.post('/api/worlds/generate', data),
  getWorldsBracket: (seasonId) => apiClient.get('/api/worlds/bracket', { params: { seasonId } }),
  getSwissStandings: (worldsId) => apiClient.get(`/api/worlds/${worldsId}/swiss-standings`),
  generateSwissRound: (worldsId) => apiClient.post(`/api/worlds/${worldsId}/generate-swiss-round`),
  generateKnockout: (worldsId) => apiClient.post(`/api/worlds/${worldsId}/generate-knockout`),
  simulateWorldsMatch: (data) => apiClient.post('/api/worlds/simulate-match', data),
}
```

---

## 8. 路由系统

**文件**：`src/router/index.ts`

### 8.1 路由定义

| 路径 | 页面 | 说明 |
|------|------|------|
| `/` | Dashboard | 仪表盘 |
| `/tournaments` | Tournaments | 赛事管理列表 |
| `/tournaments/:id` | TournamentDetail | 赛事详情（春夏常规赛） |
| `/tournaments/summer/:id` | SummerDetail | 夏季赛详情 |
| `/tournaments/msi` | MSIDetail | MSI季中邀请赛 |
| `/tournaments/worlds` | WorldsDetail | S世界赛 |
| `/tournaments/clauch/:id` | ClauchDetail | C洲际赛 |
| `/tournaments/madrid/:id` | MadridDetail | 马德里大师赛 |
| `/tournaments/shanghai` | ShanghaiDetail | 上海大师赛 |
| `/tournaments/icp/:id` | ICPDetail | ICP洲际对抗赛 |
| `/tournaments/super/:id` | SuperDetail | Super洲际邀请赛 |
| `/teams` | Teams | 战队管理 |
| `/teams/:id` | TeamDetail | 战队详情 |
| `/teams/:id/edit` | TeamEdit | 编辑战队 |
| `/players` | Players | 选手中心 |
| `/players/:id` | PlayerDetail | 选手详情 |
| `/draft` | Draft | 选秀系统 |
| `/draft/pool` | DraftPool | 选手池管理 |
| `/draft/:region` | DraftRegion | 赛区选秀 |
| `/transfer` | Transfer | 转会市场 |
| `/rankings` | Rankings | 积分排名 |
| `/player-statistics` | PlayerStatistics | 选手统计 |
| `/honors` | Honors | 荣誉殿堂 |
| `/settings` | Settings | 系统设置 |

---

## 9. 页面视图

### 9.1 仪表盘 (Dashboard.vue)

- 当前赛季信息
- 当前阶段进度
- 快速操作入口
- 最近比赛结果

### 9.2 赛事详情 (TournamentDetail.vue)

- 赛程表（分轮次显示）
- 积分榜（4赛区Tab切换）
- 模拟操作（模拟当前轮/一键模拟全部）
- 进度条（当前轮次/总轮次）

### 9.3 MSI详情 (MSIDetail.vue)

- 双败淘汰赛对阵图
- 参赛队伍列表（12支：各赛区前3）
- 积分分配说明
- 一键模拟功能

### 9.4 世界赛详情 (WorldsDetail.vue)

- 瑞士轮阶段
  - 5轮瑞士轮对阵
  - 实时积分榜（3胜晋级/3负淘汰）
- 淘汰赛阶段
  - 8强对阵图
  - 半决赛/决赛

### 9.5 积分排名 (Rankings.vue)

- 年度积分总榜
- 各项积分明细（春/夏/季后/MSI/世界赛）
- 积分明细弹窗
- 赛区筛选

---

## 10. 数据流架构

### 10.1 整体数据流

```
┌─────────────────────────────────────────────────────────────────┐
│                         Vue 组件层                               │
│  Dashboard.vue  │  TournamentDetail.vue  │  Rankings.vue  │ ... │
└─────────────────────────────────────────────────────────────────┘
                              ↓ ↑
┌─────────────────────────────────────────────────────────────────┐
│                       Pinia Store 层                             │
│  useScheduleStore │ usePlayoffStore │ useRankingStore │ ...     │
└─────────────────────────────────────────────────────────────────┘
                              ↓ ↑
┌─────────────────────────────────────────────────────────────────┐
│                         API 接口层                               │
│  competitionApi  │  playoffApi  │  worldsApi  │  rankingApi     │
└─────────────────────────────────────────────────────────────────┘
                              ↓ ↑
┌─────────────────────────────────────────────────────────────────┐
│                       Tauri 后端 (Rust)                          │
│  数据库  │  业务逻辑  │  文件系统                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 10.2 比赛模拟数据流

```
用户点击"模拟"
       ↓
Store.simulateMatch()
       ↓
API.simulateRound()
       ↓
后端执行模拟 (PowerEngine)
       ↓
返回比赛结果
       ↓
Store更新状态
       ↓
Vue组件响应式更新
       ↓
UI显示新结果
```

### 10.3 积分更新数据流

```
比赛完成
    ↓
useScheduleStore.updateScoreboard()
    ↓
useRankingStore.updateRegionalStandings()
    ↓
API.updateRegionalStandings()
    ↓
后端更新数据库
    ↓
返回新积分榜
    ↓
Store更新
    ↓
Rankings.vue 显示更新
```

---

## 附录

### A. Mock数据

项目包含完整的Mock数据用于开发测试：

- 4个赛区（LPL/LCK/LEC/LCS）
- 40支战队（每赛区10支）
- 完整的战队战力和统计数据

### B. 环境变量

```
VITE_USE_MOCK=true     # 使用Mock数据
VITE_API_BASE_URL=...  # API基础URL
```

### C. 开发命令

```bash
# 开发模式
npm run dev

# 构建
npm run build

# Tauri开发
npm run tauri dev

# Tauri构建
npm run tauri build
```

---

*文档版本: 1.0*
*最后更新: 2025-12-10*
